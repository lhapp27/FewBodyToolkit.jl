<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>3D: ps- system · FewBodyToolkit.jl</title><meta name="title" content="3D: ps- system · FewBodyToolkit.jl"/><meta property="og:title" content="3D: ps- system · FewBodyToolkit.jl"/><meta property="twitter:title" content="3D: ps- system · FewBodyToolkit.jl"/><meta name="description" content="Documentation for FewBodyToolkit.jl."/><meta property="og:description" content="Documentation for FewBodyToolkit.jl."/><meta property="twitter:description" content="Documentation for FewBodyToolkit.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FewBodyToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../BasisFunctions/">Basis Functions</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Two-body</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../example1D/">1D Example</a></li><li><a class="tocitem" href="../example2D/">2D Example</a></li><li><a class="tocitem" href="../example3D/">3D Example</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox" checked/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Three-body</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../3B1D_23body/">1D: Consistency with 2-body</a></li><li><a class="tocitem" href="../1D_2+1/">1D: 2+1 system</a></li><li><a class="tocitem" href="../ISGL_HD+/">3D: HD+ system</a></li><li class="is-active"><a class="tocitem" href>3D: ps- system</a><ul class="internal"><li><a class="tocitem" href="#Setup"><span>Setup</span></a></li><li><a class="tocitem" href="#Input-parameters:"><span>Input parameters:</span></a></li><li><a class="tocitem" href="#Obtaining-energies-and-observables"><span>Obtaining energies and observables</span></a></li><li><a class="tocitem" href="#Comparison-with-literature-values"><span>Comparison with literature values</span></a></li><li><a class="tocitem" href="#page-References"><span>page References</span></a></li></ul></li></ul></li></ul></li><li><a class="tocitem" href="../AdvancedOptions/">Advanced Options</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li><a class="is-disabled">Three-body</a></li><li class="is-active"><a href>3D: ps- system</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>3D: ps- system</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lhapp27/FewBodyToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lhapp27/FewBodyToolkit.jl/blob/main/examples/ISGL_ps-.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Three-body-Coulomb-problem-in-3D:-ps-(electron,-electron,-positron)"><a class="docs-heading-anchor" href="#Three-body-Coulomb-problem-in-3D:-ps-(electron,-electron,-positron)">Three-body Coulomb problem in 3D: ps- (electron, electron, positron)</a><a id="Three-body-Coulomb-problem-in-3D:-ps-(electron,-electron,-positron)-1"></a><a class="docs-heading-anchor-permalink" href="#Three-body-Coulomb-problem-in-3D:-ps-(electron,-electron,-positron)" title="Permalink"></a></h1><p>In this example we solve the three-body Coulomb problem of two electrons and a positron in 3D using the ISGL module. The code calculates the bound states and observables like the mean radii between two of the three particles. The results are compared with the high-precision state-of-the-art literature values of [<a href="../references/#frolov1999">4</a>].</p><h2 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Printf, FewBodyToolkit</code></pre><h2 id="Input-parameters:"><a class="docs-heading-anchor" href="#Input-parameters:">Input parameters:</a><a id="Input-parameters:-1"></a><a class="docs-heading-anchor-permalink" href="#Input-parameters:" title="Permalink"></a></h2><p>Define pair-interactions:</p><pre><code class="language-julia hljs">vee(r) = +1/r #electron-electron: V12
vep(r) = -1/r #positron-electron: V31, V23</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">vep (generic function with 1 method)</code></pre><p>Physical parameters</p><pre><code class="language-julia hljs">mass_arr=[1.0,1.0,1.0] # array of masses of particles (m1,m2,m3), here: electron, electron, positron
svals=[&quot;b&quot;,&quot;b&quot;,&quot;z&quot;] # since the two electrons are in asymmetric spin states, we can treat them as bosons for the spatial part
phys_params = make_phys_params3B3D(;mass_arr, svals, vint_arr=[[vep],[vep],[vee]]);</code></pre><p>numerical parameters:</p><pre><code class="language-julia hljs">gp = (;nmax=10,Nmax=10,r1=0.1,rnmax=25.0,R1=0.1,RNmax=25.0)
num_params = make_num_params3B3D(;gem_params=gp);</code></pre><p>In this example we also calculate central observables like the mean radii (and squared radii) between two of the three particles. With &quot;central&quot;, we mean observables of any form that only depend on <span>$r$</span>, the direct distance between two particles. For this we define the observables as functions:</p><pre><code class="language-julia hljs">rad(r) = r # radius
invrad(r) = 1/r # inverse radius
rad2(r) = r^2; # squared radius</code></pre><p>The code also allows for the observable <span>$\langle R^2\rangle$</span> in the other Jacobi coordinate, via the input <code>R2_arr</code>.</p><pre><code class="language-julia hljs">stateindices = [1] # for which states to calculate observables
observ_params = (stateindices,centobs_arr = [[rad,invrad,rad2],[rad,invrad,rad2],[rad,invrad,rad2]],R2_arr = [1,1,1] ) # R2_arr=[0,0,0] means no R^2 calculation</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(stateindices = [1], centobs_arr = Vector{Function}[[Main.var&quot;Main&quot;.rad, Main.var&quot;Main&quot;.invrad, Main.var&quot;Main&quot;.rad2], [Main.var&quot;Main&quot;.rad, Main.var&quot;Main&quot;.invrad, Main.var&quot;Main&quot;.rad2], [Main.var&quot;Main&quot;.rad, Main.var&quot;Main&quot;.invrad, Main.var&quot;Main&quot;.rad2]], R2_arr = [1, 1, 1])</code></pre><h2 id="Obtaining-energies-and-observables"><a class="docs-heading-anchor" href="#Obtaining-energies-and-observables">Obtaining energies and observables</a><a id="Obtaining-energies-and-observables-1"></a><a class="docs-heading-anchor-permalink" href="#Obtaining-energies-and-observables" title="Permalink"></a></h2><p>Using the optional keyword argument <code>observ_params</code> (together with <code>wf_bool=1</code>) we can obtain the results for the observables on-the-fly. The energies are stored in the <code>energies</code> array, the eigenvectors in <code>wfs</code>, and the central observables in <code>co_out</code>. The mean squared radii for the R-coordinate are stored in <code>R2_out</code>.</p><pre><code class="language-julia hljs">energies,wfs,co_out,R2_out = ISGL.ISGL_solve(phys_params,num_params;observ_params,wf_bool=1);</code></pre><h2 id="Comparison-with-literature-values"><a class="docs-heading-anchor" href="#Comparison-with-literature-values">Comparison with literature values</a><a id="Comparison-with-literature-values-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-with-literature-values" title="Permalink"></a></h2><pre><code class="language-julia hljs">simax = 1 # only 1 bound state
num_arr = energies[1:simax];
ex_arr = -[0.262005070232978][1:simax]; # literature value for the energy</code></pre><h4 id="Energy-spectrum"><a class="docs-heading-anchor" href="#Energy-spectrum">Energy spectrum</a><a id="Energy-spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-spectrum" title="Permalink"></a></h4><pre><code class="language-julia hljs">println(&quot;ps-:  binding energy:&quot;)
comparison(num_arr, ex_arr, simax; s1=&quot;Numeric&quot;, s2=&quot;Literature&quot;)
println(&quot;---------------------------------------------------&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ps-:  binding energy:
Index   Numeric         Literature      Difference
1       -0.261815       -0.262005       -0.000190
---------------------------------------------------</code></pre><p>We find good agreement with the literature value</p><h4 id="Mean-values-for-the-radii,-inverse-radii,-and-squared-radii-for-the-r-coordinate"><a class="docs-heading-anchor" href="#Mean-values-for-the-radii,-inverse-radii,-and-squared-radii-for-the-r-coordinate">Mean values for the radii, inverse radii, and squared radii for the r-coordinate</a><a id="Mean-values-for-the-radii,-inverse-radii,-and-squared-radii-for-the-r-coordinate-1"></a><a class="docs-heading-anchor-permalink" href="#Mean-values-for-the-radii,-inverse-radii,-and-squared-radii-for-the-r-coordinate" title="Permalink"></a></h4><p>Literature values for radii (<code>ee</code> indicates the electron-electron distance, and <code>pe</code> the positron-electron distance):</p><pre><code class="language-julia hljs">ree_lit = [8.54858] #r21
rpe_lit = [5.48963] #r31
r_lit = [rpe_lit,rpe_lit,ree_lit];</code></pre><p>... inverse radii:</p><pre><code class="language-julia hljs">iree_lit = [0.15563] #1/r21
irpe_lit = [0.33982] #1/r31
ir_lit = [irpe_lit,irpe_lit,iree_lit];</code></pre><p>... and square radii:</p><pre><code class="language-julia hljs">ree2_lit = [93.1786] #r21^2
rpe2_lit = [48.4189] #r31^2
r2_lit = [rpe2_lit,rpe2_lit,ree2_lit];</code></pre><p>Comparison of the numerical results with the literature:</p><pre><code class="language-julia hljs">println(&quot;\nps-:  radii ⟨r⟩ with differences&quot;)
strings = [&quot;r_pe&quot;,&quot;r_pe&quot;,&quot;r_ee&quot;]
for ii in [1,2,3]
    comparison(co_out[ii,1,stateindices], r_lit[ii], simax; s1=strings[ii], s2=string(strings[ii],&quot;(lit)&quot;))
end
println(&quot;---------------------------------------------------&quot;)

println(&quot;\nps-:  inverse radii ⟨1/r⟩ with differences&quot;)
strings = [&quot;1/r_pe&quot;,&quot;1/r_pe&quot;,&quot;1/r_ee&quot;]
for ii in [1,2,3]
    comparison(co_out[ii,2,stateindices], ir_lit[ii], simax; s1=strings[ii], s2=string(strings[ii],&quot;(lit)&quot;))
end
println(&quot;---------------------------------------------------&quot;)

println(&quot;\nps-:  squared radii ⟨r²⟩ with differences&quot;)
strings2 = [&quot;r²_pe&quot;,&quot;r²_pe&quot;,&quot;r²_ee&quot;]
for ii in [1,2,3]
    comparison(co_out[ii,3,stateindices], r2_lit[ii], simax; s1=strings2[ii], s2=string(strings2[ii],&quot;(lit)&quot;))
end
println(&quot;---------------------------------------------------&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
ps-:  radii ⟨r⟩ with differences
Index   r_pe            r_pe(lit)       Difference
1       5.499094        5.489630        -0.009464
Index   r_pe            r_pe(lit)       Difference
1       5.499094        5.489630        -0.009464
Index   r_ee            r_ee(lit)       Difference
1       8.542070        8.548580        0.006510
---------------------------------------------------

ps-:  inverse radii ⟨1/r⟩ with differences
Index   1/r_pe          1/r_pe(lit)     Difference
1       0.339703        0.339820        0.000117
Index   1/r_pe          1/r_pe(lit)     Difference
1       0.339703        0.339820        0.000117
Index   1/r_ee          1/r_ee(lit)     Difference
1       0.155783        0.155630        -0.000153
---------------------------------------------------

ps-:  squared radii ⟨r²⟩ with differences
Index   r²_pe           r²_pe(lit)      Difference
1       48.633676       48.418900       -0.214776
Index   r²_pe           r²_pe(lit)      Difference
1       48.633676       48.418900       -0.214776
Index   r²_ee           r²_ee(lit)      Difference
1       93.050415       93.178600       0.128185
---------------------------------------------------</code></pre><p>Since there is only one bound state, we can reproduce both energies and geometric properties with good accuracy. In contrast, the HD+ system supports several excited states, whose geometric properties are difficult to describe by the simple centered Gaussian basis functions.</p><h4 id="Mean-squared-radii-for-the-R-coordinate"><a class="docs-heading-anchor" href="#Mean-squared-radii-for-the-R-coordinate">Mean squared radii for the R-coordinate</a><a id="Mean-squared-radii-for-the-R-coordinate-1"></a><a class="docs-heading-anchor-permalink" href="#Mean-squared-radii-for-the-R-coordinate" title="Permalink"></a></h4><p>For this observable the reference does not provide any direct comparison value, so we just print the numerical results:</p><pre><code class="language-julia hljs">println(&quot;\nps+:  Mean squared radii ⟨R²⟩&quot;)
row_labels = [&quot;Electron 1 rel. to (e-_2,p+) pair:  &quot;, &quot;Electron 2 rel. to (p+,e-_1) pair:  &quot;, &quot;Positron rel. to (e-_1,e-_2) pair:  &quot;]
state_labels = [&quot;Ground state&quot;]
println(rpad(&quot; ⟨R²⟩ &quot;, 37), join(state_labels, &quot;   &quot;))
for i in 1:length(row_labels)
    print(rpad(row_labels[i], 30))
    for j in 1:length(state_labels)
        print(@sprintf(&quot;%10.4f&quot;, R2_out[i, j]))
    end
    println()
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
ps+:  Mean squared radii ⟨R²⟩
 ⟨R²⟩                                Ground state
Electron 1 rel. to (e-_2,p+) pair:     58.6836
Electron 2 rel. to (p+,e-_1) pair:     58.6836
Positron rel. to (e-_1,e-_2) pair:     25.3711</code></pre><p>Since particles 1 and 2 are identical electrons, the first two rows are identical. The third row shows the results for the positron with respect to the center-of-mass of the electron-electron pair and are clearly smaller, probably since it feels an attractive Coulomb force of twice the strength (the effective pair of the two electrons has charge -2).</p><h2 id="page-References"><a class="docs-heading-anchor" href="#page-References">page References</a><a id="page-References-1"></a><a class="docs-heading-anchor-permalink" href="#page-References" title="Permalink"></a></h2><div class="citation noncanonical"><dl><dt>[4]</dt><dd><div>A. M. Frolov. <a href="https://link.aps.org/doi/10.1103/PhysRevA.60.2834"><em>Bound-state properties of the positronium negative ion Ps<span>$^-$</span></em></a>. <a href="https://doi.org/10.1103/PhysRevA.60.2834">Phys. Rev. A <strong>60</strong>, 2834–2839</a> (1999).</div></dd></dl></div><p>See also the <a href="../references/#References">full bibliography</a> for further references cited throughout this documentation.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ISGL_HD+/">« 3D: HD+ system</a><a class="docs-footer-nextpage" href="../AdvancedOptions/">Advanced Options »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 8 August 2025 01:00">Friday 8 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
