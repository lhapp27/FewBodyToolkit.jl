<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>3B3D: HD+ system · FewBodyToolkit.jl</title><meta name="title" content="3B3D: HD+ system · FewBodyToolkit.jl"/><meta property="og:title" content="3B3D: HD+ system · FewBodyToolkit.jl"/><meta property="twitter:title" content="3B3D: HD+ system · FewBodyToolkit.jl"/><meta name="description" content="Documentation for FewBodyToolkit.jl."/><meta property="og:description" content="Documentation for FewBodyToolkit.jl."/><meta property="twitter:description" content="Documentation for FewBodyToolkit.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FewBodyToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../BasisFunctions/">Basis Functions</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/">Overview</a></li><li><a class="tocitem" href="../example1D/">2B: Example 1D</a></li><li><a class="tocitem" href="../example2D/">2B: Example 2D</a></li><li><a class="tocitem" href="../example3D/">2B: Example 3D</a></li><li><a class="tocitem" href="../3B1D_23body/">3B1D: Consistency with 2-body</a></li><li><a class="tocitem" href="../1D_2+1/">3B1D: 2+1 system</a></li><li class="is-active"><a class="tocitem" href>3B3D: HD+ system</a><ul class="internal"><li><a class="tocitem" href="#Setup"><span>Setup</span></a></li><li><a class="tocitem" href="#Input-parameters:"><span>Input parameters:</span></a></li><li><a class="tocitem" href="#Obtaining-energies-and-observables"><span>Obtaining energies and observables</span></a></li><li><a class="tocitem" href="#Comparison-with-literature-values"><span>Comparison with literature values</span></a></li><li><a class="tocitem" href="#page-References"><span>page References</span></a></li></ul></li><li><a class="tocitem" href="../ISGL_ps-/">3B3D: ps- system</a></li></ul></li><li><a class="tocitem" href="../AdvancedOptions/">Advanced Options</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>3B3D: HD+ system</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>3B3D: HD+ system</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lhapp27/FewBodyToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lhapp27/FewBodyToolkit.jl/blob/main/examples/ISGL_HD+.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Three-body-Coulomb-problem-in-3D:-HD-(proton,-deuteron,-electron)"><a class="docs-heading-anchor" href="#Three-body-Coulomb-problem-in-3D:-HD-(proton,-deuteron,-electron)">Three-body Coulomb problem in 3D: HD+ (proton, deuteron, electron)</a><a id="Three-body-Coulomb-problem-in-3D:-HD-(proton,-deuteron,-electron)-1"></a><a class="docs-heading-anchor-permalink" href="#Three-body-Coulomb-problem-in-3D:-HD-(proton,-deuteron,-electron)" title="Permalink"></a></h1><p>In this example we solve the three-body Coulomb problem of a proton, deuteron and electron in 3D using the ISGL module. The code calculates the bound states and observables like the mean radii between two of the three particles. The results are compared with the high-precision state-of-the-art literature values of [<a href="../references/#bubin2005">3</a>].</p><h2 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Printf, FewBodyToolkit</code></pre><h2 id="Input-parameters:"><a class="docs-heading-anchor" href="#Input-parameters:">Input parameters:</a><a id="Input-parameters:-1"></a><a class="docs-heading-anchor-permalink" href="#Input-parameters:" title="Permalink"></a></h2><p>Define pair-interactions:</p><pre><code class="language-julia hljs">vde(r) = -1/r #deuteron-electron = V23 = V1
vep(r) = -1/r #electron-proton = V31 = V2
vpd(r) = +1/r; #proton-deuteron = V12 = V3</code></pre><p>Physical parameters</p><pre><code class="language-julia hljs">mass_arr=[1836.15267343,3670.48296788,1.00] # array of masses of particles (m1,m2,m3), here: proton, deuteron, electron
phys_params = make_phys_params3B3D(;mass_arr,vint_arr=[[vde],[vep],[vpd]]);</code></pre><p>numerical parameters:</p><pre><code class="language-julia hljs">gp = (;nmax=25,Nmax=25,r1=0.1,rnmax=25.0,R1=0.1,RNmax=25.0)
num_params = make_num_params3B3D(;gem_params=gp);</code></pre><p>In this example we also calculate central observables like the mean radii (and squared radii) between two of the three particles. With &quot;central&quot;, we mean observables of any form that only depend on <span>$r$</span>, the direct distance between two particles. For this we define the observables as functions:</p><pre><code class="language-julia hljs">rad(r) = r # radius
rad2(r) = r^2; # squared radius</code></pre><p>The code also allows for the observable <span>$\langle R^2\rangle$</span> in the other Jacobi coordinate, via the input <code>R2_arr</code>.</p><pre><code class="language-julia hljs">stateindices = 1:3 # for which states to calculate observables
observ_params = (stateindices,centobs_arr = [[rad,rad2],[rad,rad2],[rad,rad2]],R2_arr = [1,1,1] ) # R2_arr=[0,0,0] means no R^2 calculation</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(stateindices = 1:3, centobs_arr = Vector{Function}[[Main.var&quot;Main+&quot;.rad, Main.var&quot;Main+&quot;.rad2], [Main.var&quot;Main+&quot;.rad, Main.var&quot;Main+&quot;.rad2], [Main.var&quot;Main+&quot;.rad, Main.var&quot;Main+&quot;.rad2]], R2_arr = [1, 1, 1])</code></pre><h2 id="Obtaining-energies-and-observables"><a class="docs-heading-anchor" href="#Obtaining-energies-and-observables">Obtaining energies and observables</a><a id="Obtaining-energies-and-observables-1"></a><a class="docs-heading-anchor-permalink" href="#Obtaining-energies-and-observables" title="Permalink"></a></h2><p>Using the optional keyword argument <code>observ_params</code> (together with <code>wf_bool=1</code>) we can obtain the results for the observables on-the-fly. The energies are stored in the <code>energies</code> array, the eigenvectors in <code>wfs</code>, and the central observables in <code>co_out</code>. The mean squared radii for the R-coordinate are stored in <code>R2_out</code>.</p><pre><code class="language-julia hljs">energies,wfs,co_out,R2_out = ISGL.ISGL_solve(phys_params,num_params;observ_params,wf_bool=1);</code></pre><h2 id="Comparison-with-literature-values"><a class="docs-heading-anchor" href="#Comparison-with-literature-values">Comparison with literature values</a><a id="Comparison-with-literature-values-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-with-literature-values" title="Permalink"></a></h2><pre><code class="language-julia hljs">compmax = min(6,lastindex(energies));
num_arr = energies[1:compmax];
ex_arr = -[0.5978979685,0.5891818291,0.5809037001,0.5730505464,0.5656110418,0.5585755200][1:compmax]; # literature values for the energies</code></pre><h4 id="Energy-spectrum"><a class="docs-heading-anchor" href="#Energy-spectrum">Energy spectrum</a><a id="Energy-spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-spectrum" title="Permalink"></a></h4><pre><code class="language-julia hljs">println(&quot;HD+:  Energies:&quot;)
comparison(num_arr, ex_arr, compmax; s1=&quot;Numeric&quot;, s2=&quot;Literature&quot;)
println(&quot;---------------------------------------------------&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">HD+:  Energies:
Index   Numeric         Literature      Difference
1       -0.596704       -0.597898       -0.001194
2       -0.584428       -0.589182       -0.004754
3       -0.569317       -0.580904       -0.011587
4       -0.550371       -0.573051       -0.022679
5       -0.530605       -0.565611       -0.035006
6       -0.514729       -0.558576       -0.043846
---------------------------------------------------</code></pre><p>We find good agreement with the values of the literature, with deviations between 10^-3 and a few percent.</p><h4 id="Mean-radii,-and-squared-radii-for-the-r-coordinate"><a class="docs-heading-anchor" href="#Mean-radii,-and-squared-radii-for-the-r-coordinate">Mean radii, and squared radii for the r-coordinate</a><a id="Mean-radii,-and-squared-radii-for-the-r-coordinate-1"></a><a class="docs-heading-anchor-permalink" href="#Mean-radii,-and-squared-radii-for-the-r-coordinate" title="Permalink"></a></h4><p>Literature values for radii (<code>dp</code> indicates deuteron-proton distance, <code>de</code> for deuteron-electron, and <code>pe</code> for proton-electron):</p><pre><code class="language-julia hljs">rdp_lit = [2.055,2.171,2.292,2.417,2.547,2.683][stateindices]
rde_lit = [1.688,1.750,1.813,1.880,1.948,2.020][stateindices]
rpe_lit = [1.688,1.750,1.814,1.881,1.950,2.022][stateindices]
r_lit = [rde_lit,rpe_lit,rdp_lit];</code></pre><p>... and square radii:</p><pre><code class="language-julia hljs">rdp2_lit = [4.268,4.855,5.492,6.185,6.942,7.771][stateindices]
rde2_lit = [3.534,3.839,4.169,4.526,4.915,5.339][stateindices]
rpe2_lit = [3.537,3.843,4.173,4.531,4.921,5.346][stateindices]
r2_lit = [rde2_lit,rpe2_lit,rdp2_lit];</code></pre><p>Comparison of the numerical results with the literature:</p><pre><code class="language-julia hljs">println(&quot;\nHD+:  radii ⟨r⟩ with differences&quot;)
strings = [&quot;r_de&quot;, &quot;r_pe&quot;, &quot;r_dp&quot;]
for ii in [3,1,2]
    comparison(co_out[ii,1,stateindices], r_lit[ii], 3; s1=strings[ii], s2=string(strings[ii],&quot;(lit)&quot;))
end
println(&quot;---------------------------------------------------&quot;)

println(&quot;\nHD+:  squared radii ⟨r²⟩ with differences&quot;)
strings2 = [&quot;r²_de&quot;, &quot;r²_pe&quot;, &quot;r²_dp&quot;]
for ii in [3,1,2]
    comparison(co_out[ii,2,stateindices], r2_lit[ii], 3; s1=strings2[ii], s2=string(strings2[ii],&quot;(lit)&quot;))
end
println(&quot;---------------------------------------------------&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
HD+:  radii ⟨r⟩ with differences
Index   r_dp            r_dp(lit)       Difference
1       2.066311        2.055000        -0.011311
2       2.245025        2.171000        -0.074025
3       2.501562        2.292000        -0.209562
Index   r_de            r_de(lit)       Difference
1       1.697330        1.688000        -0.009330
2       1.797817        1.750000        -0.047817
3       1.939290        1.813000        -0.126290
Index   r_pe            r_pe(lit)       Difference
1       1.696797        1.688000        -0.008797
2       1.794693        1.750000        -0.044693
3       1.937508        1.814000        -0.123508
---------------------------------------------------

HD+:  squared radii ⟨r²⟩ with differences
Index   r²_dp           r²_dp(lit)      Difference
1       4.347953        4.268000        -0.079953
2       5.568124        4.855000        -0.713124
3       7.278032        5.492000        -1.786032
Index   r²_de           r²_de(lit)      Difference
1       3.595428        3.534000        -0.061428
2       4.309587        3.839000        -0.470587
3       5.216165        4.169000        -1.047165
Index   r²_pe           r²_pe(lit)      Difference
1       3.588360        3.537000        -0.051360
2       4.231156        3.843000        -0.388156
3       5.187910        4.173000        -1.014910
---------------------------------------------------</code></pre><p>For the mean radii, the results for the ground state are still quite good, however accuracy decreases quickly for higher excited states. The repulsive Coulomb interaction between proton and deuteron poses a difficult problem for the centered Gaussian basis functions. Accordingly, the largest deviations are found for the (squared) radii of the proton-deuteron pair. Other types of basis functions might prove more suitable to capture the details of the system.</p><h4 id="Mean-squared-radii-for-the-R-coordinate"><a class="docs-heading-anchor" href="#Mean-squared-radii-for-the-R-coordinate">Mean squared radii for the R-coordinate</a><a id="Mean-squared-radii-for-the-R-coordinate-1"></a><a class="docs-heading-anchor-permalink" href="#Mean-squared-radii-for-the-R-coordinate" title="Permalink"></a></h4><p>For this observable the reference does not provide any values, so we just print the numerical results:</p><pre><code class="language-julia hljs">println(&quot;\nHD+:  Mean squared radii ⟨R²⟩&quot;)
row_labels = [&quot;Proton rel. to (D+,e-) pair:  &quot;, &quot;Deuteron rel. to (e-,p+) pair:&quot;, &quot;Electron rel. to (p+,D+) pair:&quot;]
state_labels = [&quot;State 1&quot;, &quot;State 2&quot;, &quot;State 3&quot;]
println(rpad(&quot; ⟨R²⟩ &quot;, 34), join(state_labels, &quot;   &quot;))
for i in 1:length(row_labels)
    print(rpad(row_labels[i], 30))
    for j in 1:length(state_labels)
        print(@sprintf(&quot;%10.4f&quot;, R2_out[i, j]))
    end
    println()
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
HD+:  Mean squared radii ⟨R²⟩
 ⟨R²⟩                             State 1   State 2   State 3
Proton rel. to (D+,e-) pair:      4.3468    5.5666    7.2760
Deuteron rel. to (e-,p+) pair:    4.3456    5.5651    7.2741
Electron rel. to (p+,D+) pair:    2.6267    3.0459    3.5891</code></pre><p>Due to the almost negligible mass of the electron, the results for ⟨R²⟩ in the first two rows are almost identical and also almost match to the first column of the mean radii ⟨r²⟩ between proton and deuteron. The third row shows the results for the electron with respect to the center-of-mass of the proton-deuteron pair and are clearly smaller, probably since it feels an attractive Coulomb force of twice the strength (the effective pair of proton and deuteron has charge +2).</p><h2 id="page-References"><a class="docs-heading-anchor" href="#page-References">page References</a><a id="page-References-1"></a><a class="docs-heading-anchor-permalink" href="#page-References" title="Permalink"></a></h2><div class="citation noncanonical"><dl><dt>[3]</dt><dd><div>S. Bubin, E. Bednarz and L. Adamowicz. <a href="https://doi.org/10.1063/1.1850905"><em>Charge asymmetry in HD+</em></a>. <a href="https://doi.org/10.1063/1.1850905">The Journal of Chemical Physics <strong>122</strong>, 041102</a> (2005).</div></dd></dl></div><p>See also the <a href="../references/#References">full bibliography</a> for further references cited throughout this documentation.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1D_2+1/">« 3B1D: 2+1 system</a><a class="docs-footer-nextpage" href="../ISGL_ps-/">3B3D: ps- system »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Wednesday 18 June 2025 15:21">Wednesday 18 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
