<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basis Functions · FewBodyToolkit.jl</title><meta name="title" content="Basis Functions · FewBodyToolkit.jl"/><meta property="og:title" content="Basis Functions · FewBodyToolkit.jl"/><meta property="twitter:title" content="Basis Functions · FewBodyToolkit.jl"/><meta name="description" content="Documentation for FewBodyToolkit.jl."/><meta property="og:description" content="Documentation for FewBodyToolkit.jl."/><meta property="twitter:description" content="Documentation for FewBodyToolkit.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FewBodyToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Basis Functions</a><ul class="internal"><li><a class="tocitem" href="#Two-Body"><span>Two-Body</span></a></li><li><a class="tocitem" href="#Three-Body"><span>Three-Body</span></a></li><li><a class="tocitem" href="#Home-References"><span>Home References</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/">Overview</a></li><li><a class="tocitem" href="../example1D/">2B: Example 1D</a></li><li><a class="tocitem" href="../example2D/">2B: Example 2D</a></li><li><a class="tocitem" href="../example3D/">2B: Example 3D</a></li><li><a class="tocitem" href="../3B1D_23body/">3B1D: Consistency with 2-body</a></li><li><a class="tocitem" href="../1D_2+1/">3B1D: 2+1 system</a></li><li><a class="tocitem" href="../ISGL_HD+/">3B3D: HD+ system</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Basis Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basis Functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lhapp27/FewBodyToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lhapp27/FewBodyToolkit.jl/blob/main/docs/src/BasisFunctions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Gaussian-Basis-Functions"><a class="docs-heading-anchor" href="#Gaussian-Basis-Functions">Gaussian Basis Functions</a><a id="Gaussian-Basis-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Gaussian-Basis-Functions" title="Permalink"></a></h1><p>This page provides an overview of the centered Gaussian basis functions used for 2‑ and 3‑body quantum calculations in our package. It covers standard real-range Gaussians, an extension to complex-ranged Gaussians, and the methods used for higher angular momenta in three-body systems. A more extensive introduction, however limited to 3D systems can be found in [<a href="../references/#hiyama2003">1</a>].</p><h2 id="Two-Body"><a class="docs-heading-anchor" href="#Two-Body">Two-Body</a><a id="Two-Body-1"></a><a class="docs-heading-anchor-permalink" href="#Two-Body" title="Permalink"></a></h2><h3 id="Real-Range-(Centered)-Gaussian-basis-functions"><a class="docs-heading-anchor" href="#Real-Range-(Centered)-Gaussian-basis-functions">Real-Range (Centered) Gaussian basis functions</a><a id="Real-Range-(Centered)-Gaussian-basis-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Real-Range-(Centered)-Gaussian-basis-functions" title="Permalink"></a></h3><p>The Gaussian expansion method relies on expanding an unknown state into a set</p><p class="math-container">\[|\phi\rangle = \sum_\alpha c_\alpha |\phi_\alpha\rangle\]</p><p>of Gaussian basis functions <span>$|\phi_\alpha\rangle$</span> . They are originally defined in 3D as</p><p class="math-container">\[\phi_\alpha^{(3D)}(r) = N_{n,l}\, r^l e^{-\nu_n r^2} Y_{l,m}(\theta,\phi)\]</p><p>with the multi-index <span>$\alpha = \{n,l\}$</span>. This definition can be extended to 1D and 2D systems by considering (the normalization depends on the dimensionality)</p><p class="math-container">\[\phi_\alpha^{(1D)}(r) = N_{n,l}\, r^l e^{-\nu_n r^2} \\
\phi_\alpha^{(2D)}(r) = N_{n,l}\, r^l e^{-\nu_n r^2} e^{im\phi}.\]</p><p>In 3D, the index <span>$l$</span> denotes the angular momentum. In 1D, we can associate even and odd values of it to the parity or symmetry of a two-body state. The index <span>$n$</span> is associated with the Gaussian ranges <span>$\nu_n$</span> which are chosen in a geometric progression</p><p class="math-container">\[\nu_n = 1/r_n^2, \qquad r_n = r_1 a^{n-1}, \qquad a = \left(\frac{r_{n_{max}}}{r_1} \right)^{1/(n_{max}-1)}\]</p><p>defined by the parameters <code>nmax</code>, <code>r1</code>, <code>rnmax</code>. This choice allows for a large function space, while keeping a low number of numerical parameters. Th series of ranges is created in the function <code>buildnu</code></p><p>Using Gaussian basis functions allows to treat many steps fully analytically, and is especially useful for 3-body calculations. However, they are not orthogonal which implies that finding the solution to a few-body problem requires solving a generalized eigenvalue problem, and not a standard one. For this, we provide the function <code>eigen2step</code>, which is similar to <code>eigen(A,B)</code>, but it removes eigenvalues of <code>B</code> below a certain threshold, to cure a possibly ill-posed problem. Such a situation can arise if a set of too many basis functions with similar ranges is used.</p><h3 id="Complex-Ranged-Gaussians"><a class="docs-heading-anchor" href="#Complex-Ranged-Gaussians">Complex-Ranged Gaussians</a><a id="Complex-Ranged-Gaussians-1"></a><a class="docs-heading-anchor-permalink" href="#Complex-Ranged-Gaussians" title="Permalink"></a></h3><p>For oscillatory states, e.g. highly excited states or metastable resonant states, it can be difficult to capture their details with standard Gaussians basis functions. A simple extension suggested in [<a href="../references/#hiyama2003">1</a>] are complex-ranged Gaussians which are obtained from the standard real-ranged ones by the transformation</p><p class="math-container">\[\nu \to \nu (1 \pm i\,\omega).\]</p><p>This allows reusing the same code structure as for real-ranged Gaussians. Note that to ensure a real wave function, always the pair of both complex shifts is used, and hence the number of basis functions is twice the one defined in <code>num_params</code>. Complex-ranged Gaussians can be used with the optional keyword argument <code>cr_bool = 1</code> when calling the solver.</p><h2 id="Three-Body"><a class="docs-heading-anchor" href="#Three-Body">Three-Body</a><a id="Three-Body-1"></a><a class="docs-heading-anchor-permalink" href="#Three-Body" title="Permalink"></a></h2><h3 id="Jacobi-Coordinates-and-Faddeev-Components"><a class="docs-heading-anchor" href="#Jacobi-Coordinates-and-Faddeev-Components">Jacobi Coordinates and Faddeev Components</a><a id="Jacobi-Coordinates-and-Faddeev-Components-1"></a><a class="docs-heading-anchor-permalink" href="#Jacobi-Coordinates-and-Faddeev-Components" title="Permalink"></a></h3><p><img src="../assets/JacobiCoordinates.svg" alt="Jacobi coordinate sets"/></p><p><strong>Figure 1</strong>: Three sets of Jacobi coordinates for a three-body system.</p><p>For three-body systems we employ Jacobi coordinates. This allows to describe the full system inits center-of-mass frame by two relative coordinates. However, there are three equivalent sets of these coordinates, related to the three different partitions of three particles into a pair of two, and a single one, see Fig. 1. In few-body physics it is therefore common to decompose any given three-body state into a sum</p><p class="math-container">\[|\Psi\rangle = |\Psi^{(1)}\rangle + |\Psi^{(2)}\rangle + |\Psi^{(3)}\rangle\]</p><p>of Faddeev components <span>$|\Psi^{(i)}\rangle$</span> (sometimes called rearrangement channels), each described in a different Jacobi set <span>$\{\vec{r}_i,\vec{R}_i\}$</span>. In case some particles do not interact, or two or more are identical, the number of Faddeev components can be reduced. The code does this automatically.</p><p>Each component is then expanded into a set</p><p class="math-container">\[\Psi^{(i)}(\vec{r}_i,\vec{R}_i) = \sum_{\alpha=1}^{\alpha_{max}} A_\alpha \psi_\alpha^{(i)}(\vec{r}_i,\vec{R}_i)\]</p><p>of basis functions <span>$\psi_\alpha^{(i)}$</span> which itself are composed of products of two functions</p><p class="math-container">\[\psi_\alpha^{(i)}(\vec{r}_i,\vec{R}_i) = \phi_\alpha(\vec{r}_i) \Phi_\alpha(\vec{R}_i).\]</p><p>These functions are each defined as in the two-body case (<a href="#Two-Body">Two-Body</a>)</p><p class="math-container">\[\phi_\alpha(\vec{r}) = N_{l,m} r^l e^{-\nu_n r^2} Y_{l,m}(\hat{r})\]</p><p class="math-container">\[\Phi_\alpha(\vec{R}) = N_{L,M} R^L e^{-\lambda_N R^2} Y_{L,M}(\hat{R})\]</p><p>where now <span>$\alpha = \{n,l,N,L\}$</span>. For 1D and 2D systems, the spherical harmonics are simply replaced by <span>$e^{i m \varphi}$</span> or 1, respectively.</p><p>The basis is automatically constructed based on the inputs <code>nmax,r1,rnmax,Nmax,R1,RNmax</code> from <code>gem_params</code> in <code>num_params</code>.</p><p>The decomposition into different Faddeev components requires that we have to compute matrix elements of the form</p><p class="math-container">\[\langle \Psi^{(a)} | \hat{O}^{(c)} |\Psi^{(b)}\rangle\]</p><p>with basis functions and operators in possibly different Jacobi sets <span>$a,b,c$</span>. Owing to the Gaussian form, this can be done readily for s-wave states, since the Gaussian form is preserved when transforming from one set to another.</p><h3 id="Higher-Angular-Momenta-via-Infinitesimally-Shifted-Gaussians"><a class="docs-heading-anchor" href="#Higher-Angular-Momenta-via-Infinitesimally-Shifted-Gaussians">Higher Angular Momenta via Infinitesimally Shifted Gaussians</a><a id="Higher-Angular-Momenta-via-Infinitesimally-Shifted-Gaussians-1"></a><a class="docs-heading-anchor-permalink" href="#Higher-Angular-Momenta-via-Infinitesimally-Shifted-Gaussians" title="Permalink"></a></h3><p>If higher angular momenta are required, the transformation between different Jacobi sets quickly becomes laborious due to the presence of multiple spherical harmonics. To avoid this, the code makes use of so-called infinitesimally shifted Gaussian basis functions, to express the spherical harmonics in terms of several Gaussians with infinitesimal shift. This shift is treated analytically before computing the matrix elements. More details on this type of basis functions can be found in the review article [<a href="../references/#hiyama2003">1</a>]. We note that this treatment is only required in 3D. In 1D, matrix elements of different Jacobi sets can be computed more easily. Hence, we have two separate modules, <a href="../api/#GEM3B1D">GEM3B1D</a> for 1D, and <a href="../api/#ISGL">ISGL</a> for 3D. Three-body systems in 2D are currently not supported.</p><h2 id="Home-References"><a class="docs-heading-anchor" href="#Home-References">Home References</a><a id="Home-References-1"></a><a class="docs-heading-anchor-permalink" href="#Home-References" title="Permalink"></a></h2><p>This page cites the following references:</p><div class="citation noncanonical"><dl><dt>[1]</dt><dd><div>E. Hiyama, Y. Kino and M. Kamimura. <em>Gaussian Expansion Method for Few-Body Systems</em>. Prog. Part. Nucl. Phys. <strong>51</strong>, 223–307 (2003).</div></dd></dl></div><p>Also see the <a href="../references/#References">full bibliography</a> for further references cited throughout this documentation.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../examples/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Friday 6 June 2025 09:02">Friday 6 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
