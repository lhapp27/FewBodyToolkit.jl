<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2D Example · FewBodyToolkit.jl</title><meta name="title" content="2D Example · FewBodyToolkit.jl"/><meta property="og:title" content="2D Example · FewBodyToolkit.jl"/><meta property="twitter:title" content="2D Example · FewBodyToolkit.jl"/><meta name="description" content="Documentation for FewBodyToolkit.jl."/><meta property="og:description" content="Documentation for FewBodyToolkit.jl."/><meta property="twitter:description" content="Documentation for FewBodyToolkit.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FewBodyToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../BasisFunctions/">Basis Functions</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox" checked/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Two-body</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../example1D/">1D Example</a></li><li class="is-active"><a class="tocitem" href>2D Example</a><ul class="internal"><li><a class="tocitem" href="#Setup"><span>Setup</span></a></li><li><a class="tocitem" href="#Input-parameters"><span>Input parameters</span></a></li><li><a class="tocitem" href="#1.-Numerical-solution"><span>1. Numerical solution</span></a></li><li><a class="tocitem" href="#2.-Optimization-of-basis-parameters"><span>2. Optimization of basis parameters</span></a></li><li><a class="tocitem" href="#3.-Inverse-problem:-Tuning-the-potential-strength"><span>3. Inverse problem: Tuning the potential strength</span></a></li><li><a class="tocitem" href="#4.-Using-complex-ranged-basis-functions"><span>4. Using complex-ranged basis functions</span></a></li></ul></li><li><a class="tocitem" href="../example3D/">3D Example</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Three-body</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../3B1D_23body/">1D: Consistency with 2-body</a></li><li><a class="tocitem" href="../1D_2+1/">1D: 2+1 system</a></li><li><a class="tocitem" href="../ISGL_HD+/">3D: HD+ system</a></li><li><a class="tocitem" href="../ISGL_ps-/">3D: ps- system</a></li></ul></li></ul></li><li><a class="tocitem" href="../AdvancedOptions/">Advanced Options</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li><a class="is-disabled">Two-body</a></li><li class="is-active"><a href>2D Example</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>2D Example</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lhapp27/FewBodyToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lhapp27/FewBodyToolkit.jl/blob/main/examples/example2D.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="2D-Example:-Two-particles-with-Harmonic-oscillator-interaction"><a class="docs-heading-anchor" href="#2D-Example:-Two-particles-with-Harmonic-oscillator-interaction">2D Example: Two particles with Harmonic oscillator interaction</a><a id="2D-Example:-Two-particles-with-Harmonic-oscillator-interaction-1"></a><a class="docs-heading-anchor-permalink" href="#2D-Example:-Two-particles-with-Harmonic-oscillator-interaction" title="Permalink"></a></h1><p>This example demonstrates how to use the <code>FewBodyToolkit.jl</code> package to compute bound states for two particles in 2D. Here we use the harmonic oscillator, since it has analytic solutions. In relative coordinates, this system is equivalent to a single particle in a potential. It is governed by the following Schrödinger equation (we set the magnetic quantum number <span>$m = 0$</span>, and <span>$\hbar = 1$</span>) \[ -\frac{1}{2 \mu} \left[\frac{d^2}{dr^2} + \frac{1}{r} \frac{d}{dr} \right] \psi + V(r)\psi = E\psi \] with the Harmonic oscillator potential \[ V(r) = -\frac{1}{2} \mu \omega^2 r^2. \]</p><h2 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Printf, Interpolations, FewBodyToolkit</code></pre><h2 id="Input-parameters"><a class="docs-heading-anchor" href="#Input-parameters">Input parameters</a><a id="Input-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Input-parameters" title="Permalink"></a></h2><h4 id="Physical-parameters"><a class="docs-heading-anchor" href="#Physical-parameters">Physical parameters</a><a id="Physical-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-parameters" title="Permalink"></a></h4><pre><code class="language-julia hljs">mass_arr=[1.0,10.0] # finite masses of the two particles
mur = 1/(1/mass_arr[1]+1/mass_arr[2]) # reduced mass
omega = 0.5

function v_ho(r)
    return 0.5*mur*omega^2*r^2
end;</code></pre><p>We define the physical parameters as a <code>NamedTuple</code> which carries the information about the Hamiltonian.</p><pre><code class="language-julia hljs">phys_params = make_phys_params2B(;mur,vint_arr=[v_ho],dim=2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(hbar = 1.0, mur = 0.9090909090909091, vint_arr = [Main.v_ho], lmin = 0, lmax = 0, dim = 2)</code></pre><p>By leaving out the optional parameters, we use the defaults:</p><ul><li><code>lmin = lmax = 0</code>: minimum and maximum angular momentum</li><li><code>hbar = 1.0</code>: when working in dimensionless units</li></ul><h4 id="Numerical-parameters"><a class="docs-heading-anchor" href="#Numerical-parameters">Numerical parameters</a><a id="Numerical-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-parameters" title="Permalink"></a></h4><pre><code class="language-julia hljs">nmax=14 # number of Gaussian basis functions
r1=0.5;rnmax=10.0;
gem_params = (;nmax,r1,rnmax);</code></pre><p>We define the numerical parameters as a <code>NamedTuple</code>:</p><pre><code class="language-julia hljs">num_params = make_num_params2B(;gem_params,threshold=10^-8)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(gem_params = (nmax = 14, r1 = 0.5, rnmax = 10.0), theta_csm = 0.0, omega_cr = 0.9, threshold = 1.0e-8)</code></pre><h2 id="1.-Numerical-solution"><a class="docs-heading-anchor" href="#1.-Numerical-solution">1. Numerical solution</a><a id="1.-Numerical-solution-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Numerical-solution" title="Permalink"></a></h2><p>We solve the two-body system by calling <code>GEM2B_solve</code>.</p><pre><code class="language-julia hljs">energies = GEM2B.GEM2B_solve(phys_params,num_params)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">14-element Vector{Float64}:
  0.5000000180534103
  1.5000041878981014
  2.500124166960195
  3.5026964830381093
  4.518213629958297
  5.608848349150882
  6.827569018709627
  8.436737550529443
 10.422138128420062
 13.198701014809242
 16.863576576376406
 21.635406739171895
 29.37390279738651
 37.87504108536926</code></pre><p>The Harmonic Oscillator has infinitely many eigenvalues. For the radially symmetric states (m = 0) their energies are given by \[ E_n = \omega (2n+1) \]</p><pre><code class="language-julia hljs">energies_exact = ([2*i for i=0:15] .+ 1) .*omega

println(&quot;1. Numerical solution of the 2D problem:&quot;)
simax=10;
comparison(energies, energies_exact, simax)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1. Numerical solution of the 2D problem:
Index   Numerical       Reference       Difference
1       0.500000        0.500000        -0.000000
2       1.500004        1.500000        -0.000004
3       2.500124        2.500000        -0.000124
4       3.502696        3.500000        -0.002696
5       4.518214        4.500000        -0.018214
6       5.608848        5.500000        -0.108848
7       6.827569        6.500000        -0.327569
8       8.436738        7.500000        -0.936738
9       10.422138       8.500000        -1.922138
10      13.198701       9.500000        -3.698701</code></pre><p>Especially for the first few states, the numerical energies are already reasonably close to the exact energies.</p><h2 id="2.-Optimization-of-basis-parameters"><a class="docs-heading-anchor" href="#2.-Optimization-of-basis-parameters">2. Optimization of basis parameters</a><a id="2.-Optimization-of-basis-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Optimization-of-basis-parameters" title="Permalink"></a></h2><p>Still, we can try to improve the accuracy by optimizing the basis parameters for a given state indicated by <code>stateindex</code>.</p><pre><code class="language-julia hljs">stateindex = 6
params_opt = GEM2B.GEM_Optim_2B(phys_params, num_params, stateindex)
gem_params_opt = (;nmax, r1 = params_opt[1], rnmax = params_opt[2])
num_params_opt = make_num_params2B(;gem_params=gem_params_opt)
energies_opt = GEM2B.GEM2B_solve(phys_params,num_params_opt)

println(&quot;\n2. Optimization of GEM parameters for E2[$stateindex]:&quot;)
@printf(&quot;%-15s %-15s %-15s %-15s %-15s\n&quot;, &quot;r1&quot;, &quot;rnmax&quot;, &quot;E2[$(stateindex-1)]&quot;, &quot;E2[$stateindex]&quot;, &quot;E2[$(stateindex+1)]&quot;)

println(&quot;Before optimization:&quot;)
@printf(&quot;%-15.6f %-15.6f %-15.6f %-15.6f %-15.6f\n&quot;, gem_params.r1, gem_params.rnmax, energies[stateindex-1], energies[stateindex], energies[stateindex+1])

println(&quot;after optimization:&quot;)
@printf(&quot;%-15.6f %-15.6f %-15.6f %-15.6f %-15.6f\n&quot;, params_opt[1], params_opt[2], energies_opt[stateindex-1], energies_opt[stateindex], energies_opt[stateindex+1])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
2. Optimization of GEM parameters for E2[6]:
r1              rnmax           E2[5]           E2[6]           E2[7]
Before optimization:
0.500000        10.000000       4.518214        5.608848        6.827569
after optimization:
0.520665        6.720280        4.527637        5.548664        6.963761</code></pre><p>The optimized parameters yield not much of an iprovement, since the basis parameters were already quite good. We can improve the results by either using more basis functions, or by complex-ranged basis functions (see below)</p><pre><code class="language-julia hljs">comparison(energies_opt,energies_exact,simax; s1=&quot;Optimized&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Index   Optimized       Reference       Difference
1       0.500000        0.500000        -0.000000
2       1.500001        1.500000        -0.000001
3       2.500186        2.500000        -0.000186
4       3.500633        3.500000        -0.000633
5       4.527637        4.500000        -0.027637
6       5.548664        5.500000        -0.048664
7       6.963761        6.500000        -0.463761
8       8.097733        7.500000        -0.597733
9       10.890227       8.500000        -2.390227
10      12.209050       9.500000        -2.709050</code></pre><h2 id="3.-Inverse-problem:-Tuning-the-potential-strength"><a class="docs-heading-anchor" href="#3.-Inverse-problem:-Tuning-the-potential-strength">3. Inverse problem: Tuning the potential strength</a><a id="3.-Inverse-problem:-Tuning-the-potential-strength-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Inverse-problem:-Tuning-the-potential-strength" title="Permalink"></a></h2><p>We can use <code>v0GEMOptim</code> to scale the interaction such that the state indicated by <code>stateindex</code> has a fixed energy <code>target_e2</code>. At the same time, the basis parameters are optimized for this state.</p><pre><code class="language-julia hljs">stateindex = 2; target_e2 = 3.0;
println(&quot;\n3. Scaling the potential such that E2[$stateindex] = $target_e2:&quot;)
phys_params_scaled,num_params_scaled,vscale = GEM2B.v0GEMOptim(phys_params,num_params_opt,stateindex,target_e2)
energies_v0 = GEM2B.GEM2B_solve(phys_params_scaled,num_params_scaled)

@printf(&quot;%-15s %-15s %-15s %-15s %-15s\n&quot;, &quot;r1&quot;, &quot;rnmax&quot;, &quot;E2[$(stateindex-1)]&quot;, &quot;E2[$stateindex]&quot;, &quot;E2[$(stateindex+1)]&quot;)
@printf(&quot;%-15.6f %-15.6f %-15.6f %-15.6f %-15.6f\n&quot;, num_params_scaled.gem_params.r1, num_params_scaled.gem_params.rnmax, energies_v0[stateindex-1], energies_v0[stateindex], energies_v0[stateindex+1])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
3. Scaling the potential such that E2[2] = 3.0:
r1              rnmax           E2[1]           E2[2]           E2[3]
0.543561        9.956515        0.999997        2.999991        5.000470</code></pre><p>Here, we scale the potential such that the energy of the state with <code>stateindex = 2</code> is equal to <code>target_e2 = 3.0</code>, i.e. twice its original value. Since the potential scales quadratically  with <span>$\omega$</span>, we expect a scaling factor of 4.0.</p><pre><code class="language-julia hljs">println(&quot;vscale = $(round(vscale,digits=8)) should be approximately 4.0&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">vscale = 3.99997547 should be approximately 4.0</code></pre><h2 id="4.-Using-complex-ranged-basis-functions"><a class="docs-heading-anchor" href="#4.-Using-complex-ranged-basis-functions">4. Using complex-ranged basis functions</a><a id="4.-Using-complex-ranged-basis-functions-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Using-complex-ranged-basis-functions" title="Permalink"></a></h2><p>We can also use complex-ranged basis functions, which are useful for more oscillatory bound states, i.e. highly excited states. Note that <code>cr_bool=1</code> effectively employs twice the number of basis functions, hence for a fair comparison we choose <code>nmaxC = nmax/2 = 7</code>. Keep in mind that the optimal parameters for the complex-ranged basis functions are usually differnt. Hence, we optimize them separately.</p><pre><code class="language-julia hljs">nmaxC = 7
r1C = 0.5; rnmaxC = 10.0;
gem_paramsC = (;nmax=nmaxC,r1=r1C,rnmax=rnmaxC);
num_paramsC = make_num_params2B(;gem_params=gem_paramsC)

stateindex = 6
params_opt = GEM2B.GEM_Optim_2B(phys_params, num_paramsC, stateindex; cr_bool = 1)
gem_params_optC = (;nmax = nmaxC, r1 = params_opt[1], rnmax = params_opt[2])
num_params_optC = make_num_params2B(;gem_params=gem_params_optC)
energies_optC= GEM2B.GEM2B_solve(phys_params,num_params_optC; cr_bool = 1)

println(&quot;\n4. Using complex-ranged basis functions:&quot;)
comparison(energies_optC, energies_exact, 14; s1=&quot;Complex-ranged&quot;, s2=&quot;Exact&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
4. Using complex-ranged basis functions:
Index   Complex-ranged  Exact           Difference
1       0.500000        0.500000        -0.000000
2       1.500000        1.500000        -0.000000
3       2.500003        2.500000        -0.000003
4       3.500003        3.500000        -0.000003
5       4.500048        4.500000        -0.000048
6       5.500048        5.500000        -0.000048
7       6.500646        6.500000        -0.000646
8       7.500646        7.500000        -0.000646
9       8.500704        8.500000        -0.000704
10      9.500705        9.500000        -0.000705
11      10.618160       10.500000       -0.118160
12      11.618171       11.500000       -0.118171
13      12.805832       12.500000       -0.305832
14      13.805883       13.500000       -0.305883</code></pre><p>Using effectively 14 basis functions, we can reproduce the exact energies for the first 10 states with less than <code>1e-3</code> deviation, and even up to 14 states with reasonable accuracy.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example1D/">« 1D Example</a><a class="docs-footer-nextpage" href="../example3D/">3D Example »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 12 August 2025 02:06">Tuesday 12 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
