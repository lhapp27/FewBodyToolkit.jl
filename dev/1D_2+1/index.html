<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>1D: 2+1 system · FewBodyToolkit.jl</title><meta name="title" content="1D: 2+1 system · FewBodyToolkit.jl"/><meta property="og:title" content="1D: 2+1 system · FewBodyToolkit.jl"/><meta property="twitter:title" content="1D: 2+1 system · FewBodyToolkit.jl"/><meta name="description" content="Documentation for FewBodyToolkit.jl."/><meta property="og:description" content="Documentation for FewBodyToolkit.jl."/><meta property="twitter:description" content="Documentation for FewBodyToolkit.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FewBodyToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../BasisFunctions/">Basis Functions</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Two-body</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../example1D/">1D Example</a></li><li><a class="tocitem" href="../example2D/">2D Example</a></li><li><a class="tocitem" href="../example3D/">3D Example</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox" checked/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Three-body</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../3B1D_23body/">1D: Consistency with 2-body</a></li><li class="is-active"><a class="tocitem" href>1D: 2+1 system</a><ul class="internal"><li><a class="tocitem" href="#Setup"><span>Setup</span></a></li><li><a class="tocitem" href="#Two-body-inverse-problem"><span>Two-body inverse problem</span></a></li><li><a class="tocitem" href="#Three-body-problem"><span>Three-body problem</span></a></li><li><a class="tocitem" href="#Two-identical-fermions"><span>Two identical fermions</span></a></li><li><a class="tocitem" href="#Page-References"><span>Page References</span></a></li></ul></li><li><a class="tocitem" href="../ISGL_HD+/">3D: HD+ system</a></li><li><a class="tocitem" href="../ISGL_ps-/">3D: ps- system</a></li></ul></li></ul></li><li><a class="tocitem" href="../AdvancedOptions/">Advanced Options</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li><a class="is-disabled">Three-body</a></li><li class="is-active"><a href>1D: 2+1 system</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>1D: 2+1 system</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lhapp27/FewBodyToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lhapp27/FewBodyToolkit.jl/blob/main/examples/1D_2+1.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="21-system-in-1D"><a class="docs-heading-anchor" href="#21-system-in-1D">2+1 system in 1D</a><a id="21-system-in-1D-1"></a><a class="docs-heading-anchor-permalink" href="#21-system-in-1D" title="Permalink"></a></h1><p>This example reproduces the results in the article [<a href="../references/#happ2019">2</a>]. It studies a one-dimensional 2+1 system of two identical particles interacting with a third particle via a central potential. Here, we consider the interaction to be either a contact interaction or a Gaussian potential, which supports a weakly-bound ground state. The two identical particles do not interact.</p><h2 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Printf, FewBodyToolkit</code></pre><p>This function returns the universal energy ratios of Table I in the article for a given mass ratio:</p><pre><code class="language-julia hljs">function exfun(mr)
    if mr == 2.2
        return [-2.1966, -1.0520]
    elseif mr == 12.4
        return [-2.5963, -1.4818, -1.1970, -1.0377, -1.0002]
    elseif mr == 22.2
        return [-2.7515, -1.6904, -1.3604, -1.1479, -1.0525, -1.0040]
    else
        error(&quot;Unknown mass ratio: $mr&quot;)
    end
end;</code></pre><h2 id="Two-body-inverse-problem"><a class="docs-heading-anchor" href="#Two-body-inverse-problem">Two-body inverse problem</a><a id="Two-body-inverse-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Two-body-inverse-problem" title="Permalink"></a></h2><p>First we define the 2+1 system via the mass ratio. Here we choose 22.2 since it results in the most bound states. Feel free to change it to either 2.2 or 12.4.</p><pre><code class="language-julia hljs">massratio = 22.2 # other values are 2.2 and 12.4
mass_arr = [1.0, massratio, massratio]
mur = 1/(1/mass_arr[1]+1/mass_arr[2]) # reduced mass
println(&quot;Mass ratio: &quot;, massratio, &quot;, reduced mass: &quot;, round(mur,digits=4))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Mass ratio: 22.2, reduced mass: 0.9569</code></pre><p>We need a potential whose ground state is weakly bound. Here, we use a Gaussian potential and set the target energy to -10^-3. Then, we find the required potential strength via the GEM2B code.</p><pre><code class="language-julia hljs">v0 = -1.0; mu_g = 1.0;
vg = GaussianPotential(v0,mu_g)

phys_params2B = make_phys_params2B(;mur,vint_arr=[vg],dim=1)
num_params2B = make_num_params2B(;gem_params=(;nmax=16, r1=1.0, rnmax=120.0))

stateindex = 1; target_e2 = -1e-3;
println(&quot;1. Two-body inverse problem&quot;)
pps,nps,vscale = GEM2B.v0GEMOptim(phys_params2B,num_params2B,stateindex,target_e2)
println(&quot;Found potential parameters: v0 = &quot;, vscale*v0, &quot;, mu_g = &quot;, mu_g)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1. Two-body inverse problem
Found potential parameters: v0 = -0.026696322347653095, mu_g = 1.0</code></pre><p>We define the rescaled potential and corresponding physical parameters</p><pre><code class="language-julia hljs">vgscaled = GaussianPotential(v0*vscale,mu_g)
pps = make_phys_params2B(;mur,vint_arr=[vgscaled],dim=1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(hbar = 1.0, mur = 0.9568965517241379, vint_arr = GaussianPotential[GaussianPotential(-0.026696322347653095, 1.0)], lmin = 0, lmax = 0, dim = 1)</code></pre><p>Check if the two-body system indeed has the desired binding energy:</p><pre><code class="language-julia hljs">e2s = GEM2B.GEM2B_solve(pps,nps)
println(&quot;Two-body binding energy: &quot;, e2s[1], &quot; (target: $(target_e2) )&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Two-body binding energy: -0.0010000000110296809 (target: -0.001 )</code></pre><p>We can also perform the calculation with a contact potential:</p><pre><code class="language-julia hljs">vc = ContactPotential1D(-sqrt(-2*target_e2),0.0)
ppc = make_phys_params2B(;mur,vint_arr=[vc],dim=1)
npc = make_num_params2B(;gem_params=(;nmax=16, r1=1.0, rnmax=120.0))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(gem_params = (nmax = 16, r1 = 1.0, rnmax = 120.0), theta_csm = 0.0, omega_cr = 0.9, threshold = 1.0e-8)</code></pre><p>For a contact interaction we don&#39;t need to find the potential strength, but parameters should be optimized</p><pre><code class="language-julia hljs">r1cs,rnmaxcs,e2copt=GEM_Optim_2B(ppc,npc,stateindex)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×3 Matrix{Float64}:
 0.00283203  83.5395  -0.000956816</code></pre><h2 id="Three-body-problem"><a class="docs-heading-anchor" href="#Three-body-problem">Three-body problem</a><a id="Three-body-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Three-body-problem" title="Permalink"></a></h2><h3 id="Two-identical-bosons"><a class="docs-heading-anchor" href="#Two-identical-bosons">Two identical bosons</a><a id="Two-identical-bosons-1"></a><a class="docs-heading-anchor-permalink" href="#Two-identical-bosons" title="Permalink"></a></h3><h4 id="Inputs"><a class="docs-heading-anchor" href="#Inputs">Inputs</a><a id="Inputs-1"></a><a class="docs-heading-anchor-permalink" href="#Inputs" title="Permalink"></a></h4><p>Having found the potential parameters, we can now set up the three-body problem with the scaled potential. For bosons we can use their symmetry with the argument <code>svals=[&quot;x&quot;,&quot;b&quot;,&quot;b&quot;]</code>, where <code>x</code> is the different particle and <code>b</code> denotes two identical bosons.</p><pre><code class="language-julia hljs">vint_arr=[[],[vgscaled],[vgscaled]] #[[v23],[v31],[v12]]
phys_params3B = make_phys_params3B1D(;mass_arr=mass_arr,svals=[&quot;x&quot;,&quot;b&quot;,&quot;b&quot;],vint_arr)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(hbar = 1.0, mass_arr = [1.0, 22.2, 22.2], svals = [&quot;x&quot;, &quot;b&quot;, &quot;b&quot;], vint_arr = Vector{Any}[[], [GaussianPotential(-0.026696322347653095, 1.0)], [GaussianPotential(-0.026696322347653095, 1.0)]], parity = 1)</code></pre><p>For the numerical parameters <code>nmax</code>, <code>r1</code>, and <code>rnmax</code> we use the optimized ones, found by the two-body inverse problem. The parameters for the other Jacobi coordinates are set manually.</p><pre><code class="language-julia hljs">nmax = nps.gem_params.nmax;
r1 = nps.gem_params.r1; rnmax = nps.gem_params.rnmax;
num_params3B = make_num_params3B1D(;gem_params=(;nmax, r1, rnmax, Nmax=16, R1=1.5, RNmax=250.0))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(lmin = 0, Lmin = 0, lmax = 0, Lmax = 0, gem_params = (nmax = 16, r1 = 0.7375, rnmax = 150.0125, Nmax = 16, R1 = 1.5, RNmax = 250.0), theta_csm = 0.0, omega_cr = 0.9, kmax_interpol = 1000, threshold = 1.0e-8)</code></pre><h4 id="Solving-the-three-body-problem"><a class="docs-heading-anchor" href="#Solving-the-three-body-problem">Solving the three-body problem</a><a id="Solving-the-three-body-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-three-body-problem" title="Permalink"></a></h4><pre><code class="language-julia hljs">println(&quot;\n2. Solving the three-body problem and comparing to the article&#39;s results&quot;)
e3 = GEM3B1D.GEM3B1D_solve(phys_params3B,num_params3B);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
2. Solving the three-body problem and comparing to the article&#39;s results</code></pre><p>We compute the ratio of three-body to two-body binding energies.</p><pre><code class="language-julia hljs">println(&quot;Results for the bosonic case, mass ratio = $massratio&quot;)
epsilon = e3 /abs(e2s[1])

ex_arr = exfun(massratio)[1:2:end]
comparison(epsilon, ex_arr, min(length(epsilon),length(ex_arr)); s1=&quot;Gaussian&quot;, s2=&quot;Contact (Ref.)&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Results for the bosonic case, mass ratio = 22.2
Index   Gaussian        Contact (Ref.)  Difference
1       -2.742642       -2.751500       -0.008858
2       -1.360521       -1.360400       0.000121
3       -1.052605       -1.052500       0.000105</code></pre><p>We can also do the calculation with a contact potential:</p><pre><code class="language-julia hljs">vint_arrC=[[],[vc],[vc]]
pp3BC = make_phys_params3B1D(;mass_arr=mass_arr,svals=[&quot;x&quot;,&quot;b&quot;,&quot;b&quot;],vint_arr = vint_arrC)
nmax = nps.gem_params.nmax;
np3BC = make_num_params3B1D(;gem_params=(;nmax, r1=r1cs, rnmax=rnmaxcs, Nmax=16, R1=1.5, RNmax=250.0))
println(&quot;\nThree-body problem with contact potential&quot;)
e3c = GEM3B1D.GEM3B1D_solve(pp3BC,np3BC);
epsilonC = e3c /abs(e2copt);

comparison(epsilonC, ex_arr, min(length(epsilonC),length(ex_arr)); s1=&quot;Contact (FBTK)&quot;, s2=&quot;Contact (Ref.)&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Three-body problem with contact potential
Index   Contact (FBTK)  Contact (Ref.)  Difference
1       -2.751575       -2.751500       0.000075
2       -1.360447       -1.360400       0.000047
3       -1.052559       -1.052500       0.000059</code></pre><h2 id="Two-identical-fermions"><a class="docs-heading-anchor" href="#Two-identical-fermions">Two identical fermions</a><a id="Two-identical-fermions-1"></a><a class="docs-heading-anchor-permalink" href="#Two-identical-fermions" title="Permalink"></a></h2><h4 id="Inputs-2"><a class="docs-heading-anchor" href="#Inputs-2">Inputs</a><a class="docs-heading-anchor-permalink" href="#Inputs-2" title="Permalink"></a></h4><p>For fermions we can use the same potential. To account for their different statistics and parity, we use <code>svals=[&quot;x&quot;,&quot;f&quot;,&quot;f&quot;]</code> and <code>parity=-1</code>. To allow for basis functions that obey these requirements, we need to set <code>lmax, Lmax=1</code>.</p><pre><code class="language-julia hljs">println(&quot;\n3. Results for the fermionic case, mass ratio = $massratio&quot;)
phys_params3B_F = make_phys_params3B1D(;mass_arr=mass_arr,svals=[&quot;x&quot;,&quot;f&quot;,&quot;f&quot;],vint_arr,parity=-1)
num_params3B_F = make_num_params3B1D(;gem_params=(;nmax, r1, rnmax, Nmax=16, R1=1.5, RNmax=250.0), lmin=0, Lmin=0, lmax=1, Lmax=1)
e3_F = GEM3B1D.GEM3B1D_solve(phys_params3B_F,num_params3B_F);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
3. Results for the fermionic case, mass ratio = 22.2</code></pre><p>We compute the ratio of three-body to two-body binding energies.</p><pre><code class="language-julia hljs">epsilon_F = e3_F /abs(e2s[1])

ex_arr_F = exfun(massratio)[2:2:end]
comparison(epsilon_F, ex_arr_F, min(length(epsilon_F),length(ex_arr_F)); s1=&quot;Gaussian&quot;, s2=&quot;Contact (Ref.)&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Index   Gaussian        Contact (Ref.)  Difference
1       -1.694973       -1.690400       0.004573
2       -1.149204       -1.147900       0.001304
3       -1.004203       -1.004000       0.000203</code></pre><p>Again, we can also do the calculation with a contact potential:</p><pre><code class="language-julia hljs">pp3BC = make_phys_params3B1D(;mass_arr=mass_arr,svals=[&quot;x&quot;,&quot;f&quot;,&quot;f&quot;],vint_arr = vint_arrC, parity=-1)
np3BC = make_num_params3B1D(;gem_params=(;nmax, r1=r1cs, rnmax=rnmaxcs, Nmax=16, R1=1.5, RNmax=250.0),lmin=0,Lmin=0,lmax=1,Lmax=1)
println(&quot;\nThree-body problem with contact potential&quot;)
e3c_F = GEM3B1D.GEM3B1D_solve(pp3BC,np3BC);
epsilonC_F = e3c_F /abs(e2copt);

comparison(epsilonC_F, ex_arr_F, min(length(epsilonC_F),length(ex_arr_F)); s1=&quot;Contact (FBTK)&quot;, s2=&quot;Contact (Ref.)&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Three-body problem with contact potential
Index   Contact (FBTK)  Contact (Ref.)  Difference
1       -1.690480       -1.690400       0.000080
2       -1.147950       -1.147900       0.000050
3       -1.004036       -1.004000       0.000036</code></pre><p>Overall, we can reproduce the article&#39;s results quite well for both bosonic and fermionic systems. For the contact interaction, the results match within the provided accuracy. For the Gaussian interaction, better results could be obtained with more basis functions and/or optimized basis parameters. Note, however, that perfect agreement between the finite-range Gaussian interaction and the contact interaction cannot be reached. Only in the limit of vanishing two-body binding energy, the two potentials should yield the same results.</p><h2 id="Page-References"><a class="docs-heading-anchor" href="#Page-References">Page References</a><a id="Page-References-1"></a><a class="docs-heading-anchor-permalink" href="#Page-References" title="Permalink"></a></h2><div class="citation noncanonical"><dl><dt>[2]</dt><dd><div>L. Happ, M. Zimmermann, S. I. Betelu, W. P. Schleich and M. A. Efremov. <a href="https://link.aps.org/doi/10.1103/PhysRevA.100.012709"><em>Universality in a one-dimensional three-body system</em></a>. <a href="https://doi.org/10.1103/PhysRevA.100.012709">Phys. Rev. A <strong>100</strong>, 012709</a> (2019).</div></dd></dl></div><p>See also the <a href="../references/#References">full bibliography</a> for further references cited throughout this documentation.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../3B1D_23body/">« 1D: Consistency with 2-body</a><a class="docs-footer-nextpage" href="../ISGL_HD+/">3D: HD+ system »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Friday 7 November 2025 02:33">Friday 7 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
